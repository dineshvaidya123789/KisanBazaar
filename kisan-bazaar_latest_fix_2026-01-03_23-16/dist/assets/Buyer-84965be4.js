import{R as k,j as e,u as q,a as Y,r,g as $,L as G}from"./index-1c33b312.js";import{L as K}from"./LocationSelector-2ca6a21e.js";const Q=k.memo(({product:s})=>{const n=s.title||s.commodity||"Unknown Product",P=s.location||s.district||"Unknown Location",o=s.price||s.targetPrice||"0",g=s.unit||s.priceUnit||"unit",l=s.quantity||"0",c=s.seller||"Unknown Seller",d=Array.isArray(s.images)&&s.images.length>0&&s.images[0],h=s.image&&typeof s.image=="string"&&s.image.length>5,i=d?s.images:h?[s.image]:[],p=i.length>0?i[0]:null,m=s.description||s.comments||"No description available",x=s.category||"Others";return e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column",height:"100%",padding:"0",overflow:"hidden"},children:[e.jsxs("div",{style:{height:"200px",backgroundColor:"#eee",position:"relative"},children:[p?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:p,alt:n,style:{width:"100%",height:"100%",objectFit:"cover"},loading:"lazy"}),i.length>1&&e.jsxs("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:"rgba(0,0,0,0.6)",color:"white",padding:"3px 8px",borderRadius:"4px",fontSize:"0.8rem",fontWeight:"bold"},children:["+",i.length-1," Photos"]})]}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#94a3b8",background:"#f8fafc",borderBottom:"1px solid #eee"},children:[e.jsx("div",{style:{fontSize:"3rem"},children:"ðŸ“¦"}),e.jsx("div",{style:{fontSize:"0.9rem",marginTop:"8px",fontWeight:"500"},children:"No Photo Provided"})]}),e.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",backgroundColor:s.type==="Buy"?"#D32F2F":"#1E4A35",color:"white",padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"bold",textTransform:"uppercase"},children:s.type==="Buy"?"WANT TO BUY":"FOR SALE"}),e.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(0,0,0,0.6)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem"},children:P})]}),e.jsxs("div",{style:{padding:"var(--spacing-md)",flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"8px"},children:[e.jsx("h3",{style:{fontSize:"1.2rem",margin:0},children:n}),e.jsx("span",{style:{backgroundColor:"#E8F5E9",color:"var(--color-primary-light)",padding:"2px 8px",borderRadius:"10px",fontSize:"0.8rem",fontWeight:"600"},children:x})]}),e.jsx("p",{style:{color:"var(--color-text-light)",fontSize:"0.9rem",marginBottom:"var(--spacing-md)",flex:1},children:m}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{display:"block",fontSize:"0.8rem",color:"#888"},children:s.type==="Buy"?"Target Price":"Price"}),e.jsxs("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--color-primary)"},children:["â‚¹",o,e.jsxs("span",{style:{fontSize:"0.9rem",color:"#666",fontWeight:"normal"},children:["/",g]})]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{display:"block",fontSize:"0.8rem",color:"#888"},children:"Quantity"}),e.jsxs("span",{style:{fontWeight:"500"},children:[l," ",g]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{className:"btn btn-outline",style:{flex:1},onClick:()=>alert(`Contacting ${c}... 
(Feature coming soon)`),children:s.type==="Buy"?"ðŸ“ž Call":"ðŸ“ž Contact"}),e.jsx("a",{href:`https://wa.me/919876543210?text=I am interested in your ${n} listing at KisanBazaar.`,target:"_blank",rel:"noopener noreferrer",className:"btn",style:{flex:1,backgroundColor:"#25D366",color:"white",borderColor:"#25D366",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:"ðŸ’¬ WhatsApp"})]})]})]})}),H=()=>{const{publicListings:s}=q(),[n,P]=Y(),[o,g]=r.useState("All"),[l,c]=r.useState(n.get("search")||""),[d,h]=r.useState(""),[i,p]=r.useState(""),[m,x]=r.useState(""),[S,B]=r.useState(""),[w,T]=r.useState(""),[y,L]=r.useState(!1);k.useEffect(()=>{const t=n.get("search");t!==null&&c(t)},[n]);const W=t=>{const a=t.target.value;c(a)},u=k.useMemo(()=>{if(!l)return{type:null,location:null,commodityTerms:[]};const t=l.toLowerCase();let a=null,z=null;t.includes("buyer")||t.includes("buy")||t.includes("want")?a="Buy":(t.includes("seller")||t.includes("sell"))&&(a="Sell");const f=t.split(/\s+/),b=[];return f.forEach(j=>{["buyer","buyers","buying","seller","sellers","selling","in","at","near","want","buy","sell"].includes(j)||b.push(j)}),{type:a,location:z,commodityTerms:b}},[l]),R=s.filter(t=>{const a=o==="All"||t.category===o,f=(C=>parseFloat(String(C||0).replace(/[^\d.]/g,""))||0)(t.price||t.targetPrice),b=S===""||f>=parseFloat(S),j=w===""||f<=parseFloat(w),F=(t.state||"").toLowerCase(),A=(t.district||(t.location?t.location.split(",").pop().trim():"")).toLowerCase(),I=(t.tehsil||(t.location?t.location.split(",")[0].trim():"")).toLowerCase(),D=!d||F.includes(d.toLowerCase()),M=!i||A.includes(i.toLowerCase()),N=!m||I.includes(m.toLowerCase());let v=!0;if(l&&(u.type&&t.type!==u.type&&(v=!1),v&&u.commodityTerms.length>0)){const C=u.commodityTerms.join(" "),E=$(C),O=(t.title||t.commodity||"").toLowerCase();E.some(U=>O.includes(U))||(v=!1)}return a&&v&&b&&j&&D&&M&&N});return e.jsxs("div",{className:"container fade-in",style:{padding:"var(--spacing-xl) 0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"var(--spacing-md)",marginBottom:"var(--spacing-lg)"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{marginBottom:"8px"},children:"à¤«à¤¼à¤¸à¤² à¤¬à¤¾à¤œà¤¼à¤¾à¤° (Marketplace)"}),e.jsxs("p",{style:{color:"var(--color-text-light)"},children:["à¤–à¤°à¥€à¤¦à¥‡à¤‚ à¤”à¤° à¤¬à¥‡à¤šà¥‡à¤‚ - à¤¸à¤­à¥€ à¤à¤• à¤œà¤—à¤¹ à¤ªà¤°",e.jsx("br",{}),"(Buy & Sell - All in one place)"]})]}),e.jsx(G,{to:"/sell",className:"btn btn-primary",children:"+ à¤ªà¥‹à¤¸à¥à¤Ÿ à¤•à¤°à¥‡à¤‚ (Post Buy/Sell)"})]}),e.jsxs("div",{style:{backgroundColor:"white",padding:"var(--spacing-md)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",marginBottom:"var(--spacing-md)",display:"flex",gap:"var(--spacing-md)",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("div",{style:{flex:1,minWidth:"250px",position:"relative"},children:e.jsx("input",{type:"text",placeholder:"Search crop name (e.g. Tamatar, Rice)...",value:l,onChange:W,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd",fontSize:"1rem"}})}),e.jsx("div",{style:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"4px"},children:["All","Vegetables","Fruits","Grains","Others"].map(t=>e.jsx("button",{onClick:()=>g(t),style:{padding:"0.5rem 1.2rem",borderRadius:"25px",border:"1px solid var(--color-primary)",backgroundColor:o===t?"var(--color-primary)":"transparent",color:o===t?"white":"var(--color-primary)",fontWeight:"600",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s"},children:t==="All"?"à¤¸à¤­à¥€ (All)":t},t))}),e.jsx("button",{onClick:()=>L(!y),style:{padding:"0.5rem 1rem",borderRadius:"8px",border:"1px solid #ccc",backgroundColor:y?"#f0f0f0":"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:y?"ðŸ”¼ Close":"ðŸ”½ Filters"})]}),y&&e.jsxs("div",{className:"advanced-filters",style:{backgroundColor:"#f8fafc",padding:"1.5rem",borderRadius:"12px",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05)",marginBottom:"var(--spacing-lg)",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem",border:"1px solid #e2e8f0",animation:"slideDown 0.3s ease-out"},children:[e.jsx("style",{children:`
                        @keyframes slideDown {
                            from { opacity: 0; transform: translateY(-10px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                        @media (max-width: 600px) {
                            .advanced-filters {
                                grid-template-columns: 1fr !important;
                                padding: 1rem !important;
                            }
                        }
                    `}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"0.85rem",color:"#64748b"},children:"ðŸ“ Location (à¤¸à¥à¤¥à¤¾à¤¨):"}),e.jsx(K,{selectedState:d,selectedDistrict:i,selectedTehsil:m,onLocationChange:t=>{h(t.state),p(t.district),x(t.tehsil)},showTehsil:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"0.85rem",color:"#64748b"},children:"ðŸ’° Price Range (â‚¹):"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("input",{type:"number",placeholder:"Min",value:S,onChange:t=>B(t.target.value),style:{width:"100%",padding:"0.6rem",borderRadius:"6px",border:"1px solid #cbd5e1"}}),e.jsx("span",{children:"-"}),e.jsx("input",{type:"number",placeholder:"Max",value:w,onChange:t=>T(t.target.value),style:{width:"100%",padding:"0.6rem",borderRadius:"6px",border:"1px solid #cbd5e1"}})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx("button",{onClick:()=>{h(""),p(""),x(""),B(""),T(""),c("")},style:{width:"100%",padding:"0.6rem 1rem",borderRadius:"6px",border:"1px solid #ef4444",color:"#ef4444",backgroundColor:"transparent",cursor:"pointer",fontWeight:"bold",fontSize:"0.85rem"},children:"ðŸ”„ Reset All"})})]}),R.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"var(--spacing-lg)"},children:R.map(t=>e.jsx(Q,{product:t},t.id))}):e.jsx("div",{style:{textAlign:"center",padding:"var(--spacing-xl)",color:"#888"},children:e.jsx("h3",{children:"No posts found matching your criteria."})})]})};export{H as default};
