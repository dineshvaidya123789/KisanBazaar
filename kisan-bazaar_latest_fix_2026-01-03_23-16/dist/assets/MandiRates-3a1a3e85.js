import{R as A,_ as T,r as x,a as I,d as M,g as w,j as e,e as C,f as B,h as P}from"./index-1c33b312.js";import{L as N}from"./LocationSelector-2ca6a21e.js";const _=A.lazy(()=>T(()=>import("./PriceTrendChart-280a2606.js"),["assets/PriceTrendChart-280a2606.js","assets/index-1c33b312.js","assets/index-48ec2abc.css"])),V=()=>{const[d,R]=x.useState({state:"",district:"",tehsil:""}),[p,y]=x.useState(""),[g,D]=x.useState("All"),[f,b]=x.useState(null),[v]=I();x.useEffect(()=>{const t=v.get("search");t&&y(t)},[v]);const z=(()=>{const t={day:"2-digit",month:"short",year:"numeric"};return new Date().toLocaleDateString("en-GB",t)})(),i=d.tehsil||d.district,L=i?M(i):[],W=["All","Fruits","Vegetables","Grains","Pulses","Others"],u=L.filter(t=>{const n=g==="All"||t.category===g;let r=!0;if(p){const o=p.toLowerCase(),a=w(o),s=t.name.toLowerCase(),c=w(s);if(r=a.some(l=>s.includes(l))||c.some(l=>l.toLowerCase().includes(o)),r||(r=s.includes(o)),!r&&o.length>=3){const l=o.substring(0,3);s.includes(l)&&(r=!0)}}return r&&n});return e.jsxs("div",{className:"container fade-in",style:{padding:"var(--spacing-lg) 0"},children:[e.jsx("h1",{style:{textAlign:"center",marginBottom:"var(--spacing-md)",color:"var(--color-primary)"},children:"‡§Ü‡§ú ‡§ï‡•á ‡§Æ‡§Ç‡§°‡•Ä ‡§≠‡§æ‡§µ (Today's Mandi Rates)"}),e.jsx("p",{style:{textAlign:"center",marginBottom:"var(--spacing-lg)",color:"#666"},children:z}),e.jsxs("div",{className:"card",style:{marginBottom:"var(--spacing-lg)",padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{style:{fontWeight:"500",color:"#555"},children:"Select Location (‡§Æ‡§Ç‡§°‡•Ä/‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç):"}),e.jsx("div",{style:{width:"100%",maxWidth:"600px"},children:e.jsx(N,{selectedState:d.state,selectedDistrict:d.district,selectedTehsil:d.tehsil,onLocationChange:R,showTehsil:!0})})]}),e.jsx("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:e.jsxs("div",{style:{width:"100%",maxWidth:"600px",position:"relative"},children:[e.jsx("input",{type:"text",placeholder:"üîç Search Crop (e.g. Wheat, Pyaaz, Kanda)...",value:p,onChange:t=>{y(t.target.value),b(null)},onFocus:()=>{},style:{width:"100%",padding:"0.8rem",borderRadius:"25px",border:"1px solid #ccc",fontSize:"1rem",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.1)"}}),p.length>1&&e.jsx("div",{className:"fade-in",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:100,maxHeight:"200px",overflowY:"auto"},children:(()=>{const n=Array.from(new Set(u.map(r=>r.name.split(" (")[0]))).filter(r=>!0);return n.length===0?null:n.map(r=>e.jsxs("div",{onClick:()=>y(r),style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px"},onMouseEnter:o=>o.target.style.backgroundColor="#f9f9f9",onMouseLeave:o=>o.target.style.backgroundColor="white",children:[e.jsx("span",{children:"üîç"}),e.jsx("span",{children:r})]},r))})()})]})}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",overflowX:"auto",paddingBottom:"0.5rem",scrollbarWidth:"none"},children:W.map(t=>e.jsx("button",{onClick:()=>D(t),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:"none",backgroundColor:g===t?"var(--color-primary)":"#f0f0f0",color:g===t?"white":"#333",cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s",fontWeight:"500"},children:t},t))})]}),e.jsx("div",{className:"card",style:{padding:"0",overflow:"hidden"},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:"600px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"var(--color-primary)",color:"white"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Crop (‡§´‡§∏‡§≤)"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center"},children:"Unit (‡§á‡§ï‡§æ‡§à)"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Min (‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ)"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Max (‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ)"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Avg (‡§î‡§∏‡§§)"})]})}),e.jsx("tbody",{children:i?u.length>0?u.map((t,n)=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:n%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{padding:"1rem",fontWeight:"500"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:t.icon}),e.jsxs("div",{children:[e.jsx("div",{children:t.name}),e.jsx("div",{style:{fontSize:"0.8rem",marginTop:"4px"},children:(()=>{const r=new Date;r.setDate(r.getDate()-1);const a=C(i,r).find(s=>s.name===t.name);if(a){const s=t.modal-a.modal,c=s>0?"#2e7d32":s<0?"#d32f2f":"#666",l=s>0?"‚ñ≤":s<0?"‚ñº":"-";return e.jsxs("span",{style:{color:c,fontWeight:"bold"},children:[l," ‚Çπ",Math.abs(s)," vs Yesterday"]})}return e.jsx("span",{style:{color:"#999"},children:"-"})})()}),e.jsxs("div",{style:{marginTop:"8px"},children:[e.jsx("button",{onClick:()=>b(f===n?null:n),style:{background:"none",border:"none",fontSize:"0.75rem",color:"var(--color-primary)",cursor:"pointer",userSelect:"none",fontWeight:"600",padding:0,display:"flex",alignItems:"center",gap:"4px"},children:f===n?"Hide Analysis üîº":"View Analysis & Nearby üìä"}),f===n&&e.jsxs("div",{className:"fade-in",style:{marginTop:"10px",backgroundColor:"white",padding:"15px",borderRadius:"8px",border:"1px solid #ddd",maxWidth:"500px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",position:"relative",zIndex:10},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h4",{style:{margin:"0 0 10px 0",fontSize:"1rem",color:"#555"},children:"üèôÔ∏è Nearby Mandis (‡§Ü‡§∏‡§™‡§æ‡§∏ ‡§ï‡•Ä ‡§Æ‡§Ç‡§°‡§ø‡§Ø‡§æ‡§Ç)"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:(()=>{const r=d.state||"Madhya Pradesh",a=B(r).filter(h=>h!==i),c=(t.name.length+((i==null?void 0:i.length)||0))%Math.max(1,a.length-3);return a.slice(c,c+3).map(h=>{const j=C(h,new Date).find(k=>k.name===t.name);if(!j)return null;const m=j.modal-t.modal,S=m>0;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"4px",fontSize:"0.9rem"},children:[e.jsxs("span",{children:["üìç ",h.split("(")[0]]}),e.jsxs("span",{style:{fontWeight:"bold",color:S?"#2e7d32":"inherit"},children:["‚Çπ",j.modal,m!==0&&e.jsxs("span",{style:{fontSize:"0.8rem",marginLeft:"6px",color:S?"#2e7d32":"#d32f2f"},children:["(",m>0?"+":"",m,")"]})]})]},h)})})()})]}),e.jsx("div",{style:{height:"1px",backgroundColor:"#eee",margin:"1rem 0"}}),e.jsx("h4",{style:{margin:"0 0 10px 0",fontSize:"1rem",color:"#555"},children:"üìà Price History (‡§™‡§ø‡§õ‡§≤‡•á 7 ‡§¶‡§ø‡§®)"}),e.jsx(A.Suspense,{fallback:e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading Chart..."}),children:e.jsx(_,{data:P(i,t.name),cropName:t.name})})]})]})]})]})}),e.jsx("td",{style:{padding:"1rem",textAlign:"center",color:"#666"},children:t.unit}),e.jsxs("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"bold",color:"#d32f2f"},children:["‚Çπ",t.min]}),e.jsxs("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"bold",color:"#388e3c"},children:["‚Çπ",t.max]}),e.jsxs("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"bold",color:"var(--color-primary)",fontSize:"1.2rem"},children:["‚Çπ",t.modal]})]},n)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",style:{padding:"2rem",textAlign:"center",color:"#666"},children:["No crops found matched your search. ",e.jsx("br",{})," (‡§ï‡•ã‡§à ‡§´‡§∏‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä)"]})}):e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",style:{padding:"4rem 2rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"üìã"}),e.jsx("h3",{style:{color:"#666"},children:"Please select a Mandi to see rates"}),e.jsx("p",{style:{color:"#888"},children:"(‡§¶‡§∞‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡§Ç‡§°‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç)"})]})})})]})})}),e.jsx("p",{style:{marginTop:"1rem",textAlign:"center",color:"#888",fontSize:"0.85rem"},children:"* Prices are estimates based on local reports. (‡§≠‡§æ‡§µ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡•ã‡§Ç ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§π‡•à‡§Ç)"})]})};export{V as default};
