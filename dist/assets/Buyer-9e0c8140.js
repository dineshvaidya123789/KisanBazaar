import{u as w,e as W,a as E,r as a,j as e,R as I,f as R,L as q,g as $}from"./index-4e9e071d.js";const F=({initialCommodity:t="",onSuccess:o})=>{const{t:n}=w(),{addBuyerRequest:i}=W(),{user:s}=E(),[h,l]=a.useState(t),[y,d]=a.useState(""),[u,c]=a.useState("kg"),[f,m]=a.useState(""),[b,g]=a.useState(!1),j=async p=>{if(p.preventDefault(),!s){alert(n("login_required")||"Please login first");return}g(!0);try{await i({commodity:h,quantity:y,unit:u,expectedPrice:f,status:"open",buyerName:s.name||"Anonymous",buyerPhone:s.phone||"",location:s.location||s.city||""}),l(""),d(""),m(""),alert("Request posted successfully!"),o&&o()}catch{alert("Failed to post request. Try again.")}finally{g(!1)}};return e.jsxs("div",{className:"card fade-in",style:{border:"2px solid var(--color-secondary)",background:"#F0FDF4"},children:[e.jsxs("h3",{style:{color:"var(--color-secondary)",marginBottom:"1rem"},children:["üìù ",n("post_buyer_request")||"Post a Request"]}),e.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"1rem",color:"#555"},children:n("cant_find_item")||"Can't find what you need? Post a request and sellers will contact you."}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"4px",fontWeight:"bold"},children:n("commodity")||"Commodity"}),e.jsx("input",{type:"text",value:h,onChange:p=>l(p.target.value),placeholder:"e.g. Onion, Wheat",required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"1rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"4px",fontWeight:"bold"},children:n("quantity")||"Quantity"}),e.jsx("input",{type:"number",value:y,onChange:p=>d(p.target.value),placeholder:"e.g. 50",required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{style:{width:"80px"},children:[e.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"4px",fontWeight:"bold"},children:n("unit")||"Unit"}),e.jsxs("select",{value:u,onChange:p=>c(p.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[e.jsx("option",{value:"kg",children:"Kg"}),e.jsx("option",{value:"quintal",children:"Quintal"}),e.jsx("option",{value:"ton",children:"Ton"})]})]})]}),e.jsx("button",{type:"submit",className:"btn",disabled:b,style:{width:"100%",background:"var(--color-secondary)",color:"white",fontWeight:"bold"},children:b?"Posting...":n("submit_request")||"Post Request"})]})]})},U=I.memo(({product:t})=>{const{t:o,language:n}=w(),i=t[`title_${n}`]||t[`title_${n==="hi"?"hi":"en"}`]||t.title||t.commodity||"Unknown Product",s=t.location||t.district||"Unknown Location",h=t.price||t.targetPrice||"0",l=t.unit||t.priceUnit||"unit",y=t.quantity||"0";t.seller;const d=Array.isArray(t.images)&&t.images.length>0&&t.images[0],u=t.image&&typeof t.image=="string"&&t.image.length>5,c=d?t.images:u?[t.image]:[],f=c.length>0?c[0]:null,m=t[`description_${n}`]||t.description||t.comments||"No description available",b=t.category||"Others";return e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column",height:"100%",padding:"0",overflow:"hidden"},children:[e.jsxs("div",{style:{height:"200px",backgroundColor:"#eee",position:"relative"},children:[f?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:f,alt:i,style:{width:"100%",height:"100%",objectFit:"cover"},loading:"lazy"}),c.length>1&&e.jsxs("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:"rgba(0,0,0,0.6)",color:"white",padding:"3px 8px",borderRadius:"4px",fontSize:"0.8rem",fontWeight:"bold"},children:["+",c.length-1," Photos"]})]}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#94a3b8",background:"#f8fafc",borderBottom:"1px solid #eee"},children:[e.jsx("div",{style:{fontSize:"3rem"},children:"üì¶"}),e.jsx("div",{style:{fontSize:"0.9rem",marginTop:"8px",fontWeight:"500"},children:o("no_photo")})]}),e.jsx("span",{style:{position:"absolute",top:"10px",left:"10px",backgroundColor:t.type==="Buy"?"#D32F2F":"#1E4A35",color:"white",padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"bold",textTransform:"uppercase"},children:t.type==="Buy"?o("want_to_buy"):o("want_to_sell")}),e.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(0,0,0,0.6)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem"},children:s})]}),e.jsxs("div",{style:{padding:"var(--spacing-md)",flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"8px"},children:[e.jsx("h3",{style:{fontSize:"1.2rem",margin:0},children:i}),e.jsx("span",{style:{backgroundColor:"#E8F5E9",color:"var(--color-primary-light)",padding:"2px 8px",borderRadius:"10px",fontSize:"0.8rem",fontWeight:"600"},children:b})]}),e.jsx("p",{style:{color:"var(--color-text-light)",fontSize:"0.9rem",marginBottom:"var(--spacing-md)",flex:1},children:m}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{display:"block",fontSize:"0.8rem",color:"#888"},children:(t.type==="Buy",o("price"))}),e.jsxs("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:t.type==="Buy"?"#D32F2F":"var(--color-primary)"},children:["‚Çπ",h,e.jsxs("span",{style:{fontSize:"0.9rem",color:"#666",fontWeight:"normal"},children:["/",l]})]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{display:"block",fontSize:"0.8rem",color:"#888"},children:t.type==="Buy"?o("needed"):o("available")}),e.jsxs("span",{style:{fontWeight:"500"},children:[y," ",l]})]})]}),t.type==="Sell"&&t.quality&&e.jsxs("div",{style:{marginBottom:"12px",fontSize:"0.85rem",color:"#666",backgroundColor:"#f9f9f9",padding:"6px 10px",borderRadius:"4px",borderLeft:"3px solid #4CAF50"},children:[e.jsxs("strong",{children:[o("quality"),":"]})," ",t.quality]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("a",{href:t.contactMobile?`tel:${t.contactMobile}`:"#",className:"btn btn-outline",style:{flex:1,textDecoration:"none",display:"flex",alignItems:"center",justifyContent:"center"},onClick:g=>{t.contactMobile||(g.preventDefault(),alert("Contact number not available for this listing."))},children:["üìû ",o("call_now")]}),e.jsxs("a",{href:t.contactMobile?`https://wa.me/${t.contactMobile}?text=Hi, I am interested in your ${i} listing on KisanBazaar.`:"#",target:"_blank",rel:"noopener noreferrer",className:"btn",style:{flex:1,backgroundColor:"#25D366",color:"white",borderColor:"#25D366",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},onClick:g=>{t.contactMobile||(g.preventDefault(),alert("Contact number not available for this listing."))},children:["üí¨ ",o("whatsapp")]})]})]})]})}),H=()=>{const{buyerPosts:t,sellerListings:o,loading:n}=W(),{t:i}=w(),[s,h]=a.useState("buy"),[l,y]=a.useState(""),[d,u]=a.useState("All"),[c,f]=a.useState({min:0,max:1e5}),[m,b]=a.useState(!1),[g,j]=a.useState(!1);a.useEffect(()=>{window.scrollTo(0,0)},[]);const p=I.useMemo(()=>{const r=new Set([...Object.keys(R),...Object.values(R)]);return Array.from(r).sort()},[]),S=(()=>(s==="buy"?o:t).filter(x=>{var C,_,B;const v=l.toLowerCase(),T=$(v),A=!l||((C=x.commodity)==null?void 0:C.toLowerCase().includes(v))||((_=x.location)==null?void 0:_.toLowerCase().includes(v))||((B=x.title)==null?void 0:B.toLowerCase().includes(v))||T.some(M=>{var z;return(z=x.commodity)==null?void 0:z.toLowerCase().includes(M)}),N=d==="All"||x.category===d;let k=parseFloat(x.price||x.expectedPrice||0);const L=k>=c.min&&k<=c.max;return A&&N&&L}))(),D=[{id:"All",icon:"üåæ",label:i("filter_all")},{id:"Vegetables",icon:"üçÖ",label:i("filter_veg")},{id:"Fruits",icon:"ü•≠",label:i("filter_fruits")},{id:"Grains",icon:"üåæ",label:i("filter_grains")}];return e.jsxs("div",{className:"buyer-page fade-in",style:{paddingBottom:"80px"},children:[e.jsxs("div",{className:"page-header",style:{background:"linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%)",color:"white",padding:"var(--spacing-xl) var(--spacing-md)",textAlign:"center",borderRadius:"0 0 var(--radius-lg) var(--radius-lg)",marginBottom:"var(--spacing-lg)",boxShadow:"0 4px 20px rgba(46, 125, 50, 0.2)",position:"relative"},children:[e.jsxs(q,{to:"/",style:{position:"absolute",top:"20px",left:"20px",color:"white",textDecoration:"none",fontWeight:"bold",display:"flex",alignItems:"center",gap:"5px",background:"rgba(255,255,255,0.2)",padding:"5px 10px",borderRadius:"20px",fontSize:"0.9rem"},children:["‚Üê ",i("back_to_home")||"Home"]}),e.jsx("h1",{style:{marginBottom:"8px",fontSize:"2rem"},children:i("marketplace_title")}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.9)",fontSize:"1.1rem"},children:i("buy_sell_hub")}),e.jsxs("button",{onClick:()=>j(!0),className:"btn fade-in",style:{marginTop:"1rem",background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.4)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer"},children:["üìù ",i("post_buyer_request")||"Post a Request"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginTop:"2rem",background:"rgba(255, 255, 255, 0.15)",padding:"6px",borderRadius:"var(--radius-xl)",maxWidth:"400px",margin:"2rem auto 0",backdropFilter:"blur(10px)"},children:[e.jsxs("button",{onClick:()=>h("buy"),style:{flex:1,padding:"12px 24px",borderRadius:"var(--radius-lg)",background:s==="buy"?"white":"transparent",color:s==="buy"?"var(--color-primary)":"white",border:"none",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:s==="buy"?"0 4px 12px rgba(0,0,0,0.1)":"none"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"üõí"})," ",i("i_want_buy")]}),e.jsxs("button",{onClick:()=>h("sell"),style:{flex:1,padding:"12px 24px",borderRadius:"var(--radius-lg)",background:s==="sell"?"white":"transparent",color:s==="sell"?"var(--color-secondary)":"white",border:"none",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:s==="sell"?"0 4px 12px rgba(0,0,0,0.1)":"none"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"üöú"})," ",i("i_want_sell")]})]})]}),e.jsxs("div",{className:"container",children:[g&&e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx(F,{onSuccess:()=>j(!1)}),e.jsx("div",{style:{textAlign:"center",marginTop:"10px"},children:e.jsx("button",{onClick:()=>j(!1),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer"},children:i("close")||"Close"})})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"var(--spacing-lg)",position:"sticky",top:"80px",zIndex:10,flexWrap:"wrap"},children:[e.jsxs("div",{style:{flex:1,position:"relative",minWidth:"280px"},children:[e.jsx("input",{type:"text",list:"marketplace-suggestions",placeholder:i("search_placeholder"),value:l,onChange:r=>y(r.target.value),style:{width:"100%",padding:"1rem 1rem 1rem 3rem",borderRadius:"var(--radius-xl)",border:"1px solid #e0e0e0",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",fontSize:"1rem"}}),e.jsx("datalist",{id:"marketplace-suggestions",children:p.map((r,x)=>e.jsx("option",{value:r},x))}),e.jsx("span",{style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",fontSize:"1.2rem",color:"#666"},children:"üîç"})]}),e.jsxs("button",{className:"btn",onClick:()=>b(!m),style:{background:m?"var(--color-primary)":"white",color:m?"white":"var(--color-primary)",border:"1px solid var(--color-primary)",borderRadius:"var(--radius-xl)",padding:"0 1.5rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"600"},children:[e.jsx("span",{children:"‚öôÔ∏è"})," ",i("filters")]})]}),m&&e.jsxs("div",{className:"fade-in",style:{background:"white",padding:"1.5rem",borderRadius:"var(--radius-lg)",marginBottom:"var(--spacing-lg)",boxShadow:"var(--shadow-md)",border:"1px solid #eee"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#666"},children:i("category")}),e.jsx("div",{style:{display:"flex",gap:"10px",overflowX:"auto",paddingBottom:"4px"},children:D.map(r=>e.jsxs("button",{onClick:()=>u(r.id),style:{padding:"8px 16px",borderRadius:"20px",border:`1px solid ${d===r.id?"var(--color-primary)":"#ddd"}`,background:d===r.id?"#e8f5e9":"white",color:d===r.id?"var(--color-primary)":"#666",cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s"},children:[r.icon," ",r.label]},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#666"},children:i("price_range")}),e.jsx("input",{type:"range",min:"0",max:"100000",step:"1000",style:{width:"100%",accentColor:"var(--color-primary)"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"4px",fontSize:"0.9rem",color:"#666"},children:[e.jsx("span",{children:"‚Çπ0"}),e.jsx("span",{children:"‚Çπ1,00,000+"})]})]})]}),n?e.jsxs("div",{style:{display:"flex",justifyContent:"center",padding:"4rem"},children:[e.jsx("div",{className:"spinner"}),e.jsx("style",{children:`
                            .spinner {
                                border: 4px solid #f3f3f3;
                                border-top: 4px solid var(--color-primary);
                                border-radius: 50%;
                                width: 40px;
                                height: 40px;
                                animation: spin 1s linear infinite;
                            }
                            @keyframes spin {
                                0% { transform: rotate(0deg); }
                                100% { transform: rotate(360deg); }
                            }
                        `})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"var(--spacing-lg)"},children:S.length===0?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"4rem 2rem",color:"#666"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem",opacity:.5},children:"üçÉ"}),e.jsx("h3",{children:i("no_posts_found")}),e.jsx("p",{children:i("try_adjusting_filters")}),e.jsxs("div",{style:{marginTop:"2rem",maxWidth:"500px",margin:"2rem auto"},children:[e.jsx("p",{style:{fontWeight:"bold",color:"var(--color-primary)"},children:i("cant_find_item")||"Can't find what you need?"}),e.jsx(F,{initialCommodity:l})]})]}):S.map(r=>e.jsx(U,{product:r},r.id))}),e.jsx("div",{style:{textAlign:"center",marginTop:"3rem",marginBottom:"1rem"},children:e.jsxs(q,{to:"/",className:"btn btn-outline",style:{padding:"0.8rem 2rem",fontSize:"1rem"},children:["üè† ",i("back_to_home")||"Back to Home"]})})]})]})]})};export{H as default};
