import{r as s,a as z,u as L,h as N,l as A,j as e}from"./index-4e9e071d.js";import{S as P}from"./SEO-6590514f.js";const I=()=>{var g,u;const[h,c]=s.useState(1),[i,x]=s.useState(""),[d,y]=s.useState(""),[b,f]=s.useState(""),[p,o]=s.useState(""),[l,a]=s.useState(!1),[v,j]=s.useState(null),{login:S,verifyOtp:_,setupRecaptcha:R}=z(),{t}=L(),B=N(),C=((u=(g=A().state)==null?void 0:g.from)==null?void 0:u.pathname)||"/",m=n=>n.replace(/[०-९]/g,r=>"०१२३४५६७८९".indexOf(r)),O=async n=>{if(n.preventDefault(),o(""),i.length!==10){o("Please enter a valid 10-digit number.");return}a(!0);try{const r=R(i),w=await S(i,r);j(w),c(2)}catch(r){console.error(r),o(r.message||"Failed to send OTP. Try again.")}finally{a(!1)}},k=async n=>{n.preventDefault(),a(!0),o("");try{await _(v,d),B(C,{replace:!0})}catch(r){console.error(r),o("Invalid OTP. Please check via SMS.")}finally{a(!1)}};return e.jsxs("div",{className:"container fade-in",style:{padding:"var(--spacing-xl) 0",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:[e.jsx(P,{title:t("login_title"),description:"Secure login for farmers and buyers."}),e.jsxs("div",{className:"card",style:{maxWidth:"400px",width:"100%",padding:"2rem"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx("h1",{style:{color:"var(--color-primary)"},children:t("login_title")}),e.jsx("p",{style:{color:"#666"},children:t("login_subtitle")})]}),p&&e.jsx("div",{style:{backgroundColor:"#ffebee",color:"#c62828",padding:"0.8rem",borderRadius:"4px",marginBottom:"1rem",textAlign:"center"},children:p}),e.jsx("div",{id:"recaptcha-container"}),h===1?e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:t("label_city")}),e.jsx("input",{type:"text",value:b,onChange:n=>f(n.target.value),placeholder:t("placeholder_city"),style:{width:"100%",padding:"0.8rem",borderRadius:"4px",border:"1px solid #ccc",fontSize:"1rem"}})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:t("label_phone")}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx("span",{style:{padding:"0.8rem",backgroundColor:"#f0f0f0",border:"1px solid #ccc",borderRight:"none",borderRadius:"4px 0 0 4px",color:"#555"},children:"+91"}),e.jsx("input",{type:"tel",value:i,onChange:n=>{const r=m(n.target.value);x(r.replace(/\D/g,""))},placeholder:t("placeholder_phone"),maxLength:"10",style:{flex:1,padding:"0.8rem",borderRadius:"0 4px 4px 0",border:"1px solid #ccc",fontSize:"1rem"},required:!0})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%",fontSize:"1.1rem",padding:"1rem"},disabled:l,children:t(l?"btn_sending":"btn_get_otp")})]}):e.jsxs("form",{onSubmit:k,children:[e.jsxs("p",{style:{textAlign:"center",marginBottom:"1rem",color:"#555"},children:[t("otp_sent_to")," ",e.jsxs("strong",{children:["+91 ",i]}),e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--color-primary)",cursor:"pointer",textDecoration:"underline"},onClick:()=>c(1),children:t("change_number")})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:t("label_enter_otp")}),e.jsx("input",{type:"text",value:d,onChange:n=>{const r=m(n.target.value);y(r)},placeholder:t("placeholder_otp"),style:{width:"100%",padding:"0.8rem",borderRadius:"4px",border:"1px solid #ccc",fontSize:"1.2rem",textAlign:"center",letterSpacing:"5px"},required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%",fontSize:"1.1rem",padding:"1rem"},disabled:l,children:t(l?"btn_verifying":"btn_verify_login")})]})]})]})};export{I as default};
