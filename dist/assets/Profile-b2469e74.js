import{u as k,a as C,i as S,r as s,j as e,C as h,D as w}from"./index-d4578f9c.js";const T=()=>{var m;const b=n=>n.replace(/[реж-реп]/g,o=>"режрезреирейрекрелремренреореп".indexOf(o)),{t}=k(),{user:i,logout:f,updateProfile:u}=C(),g=S(),[x,a]=s.useState(!1),[d,c]=s.useState(Notification.permission),[z,y]=s.useState(null),j=async()=>{if(!h){alert("Messaging not supported on this device/browser.");return}try{c("loading");const n=await Notification.requestPermission();if(c(n),n==="granted"){const o=await w(h);console.log("FCM Token:",o),y(o)}}catch(n){console.error("Error enabling notifications:",n),c("error")}},[l,r]=s.useState({name:(i==null?void 0:i.name)||"",phone:(i==null?void 0:i.phone)||"",village:(i==null?void 0:i.village)||"",landSize:(i==null?void 0:i.landSize)||"",crops:((m=i==null?void 0:i.crops)==null?void 0:m.join(", "))||""}),v=()=>{f(),g("/")},_=n=>{n.preventDefault();const o=l.crops.split(",").map(p=>p.trim()).filter(p=>p);u({...l,crops:o}),a(!1)};return i?e.jsx("div",{className:"container fade-in",style:{padding:"var(--spacing-xl) 0",maxWidth:"800px"},children:e.jsxs("div",{className:"card",style:{padding:"0",overflow:"hidden"},children:[e.jsx("div",{style:{backgroundColor:"var(--color-primary)",height:"120px",position:"relative"},children:e.jsx("div",{style:{position:"absolute",bottom:"-40px",left:"50%",transform:"translateX(-50%)",border:"5px solid white",borderRadius:"50%",overflow:"hidden",width:"100px",height:"100px",backgroundColor:"white"},children:e.jsx("img",{src:i.avatar,alt:"Avatar",style:{width:"100%",height:"100%"}})})}),e.jsxs("div",{style:{marginTop:"50px",padding:"2rem",textAlign:"center"},children:[e.jsx("h2",{style:{margin:"0 0 5px 0"},children:i.name}),e.jsxs("p",{style:{color:"#666",margin:0},children:["ЁЯУН ",i.village," | ЁЯУЮ ",i.phone]}),i.isVerified&&e.jsx("div",{style:{marginTop:"10px",display:"inline-block",backgroundColor:"#e8f5e9",color:"#2e7d32",padding:"4px 12px",borderRadius:"15px",fontSize:"0.9rem",fontWeight:"bold"},children:t("verified_farmer_badge")})]}),e.jsx("hr",{style:{border:"none",borderTop:"1px solid #eee",margin:0}}),e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{margin:0},children:t("farm_details_title")}),!x&&e.jsx("button",{className:"btn btn-outline",onClick:()=>a(!0),children:t("cnt_edit_profile")})]}),x?e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:t("label_profile_name")}),e.jsx("input",{type:"text",value:l.name,onChange:n=>r({...l,name:n.target.value}),style:{width:"100%",padding:"0.6rem",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:t("label_profile_phone")}),e.jsx("input",{type:"text",value:l.phone,onChange:n=>{const o=b(n.target.value);r({...l,phone:o})},style:{width:"100%",padding:"0.6rem",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:t("label_profile_village")}),e.jsx("input",{type:"text",value:l.village,onChange:n=>r({...l,village:n.target.value}),style:{width:"100%",padding:"0.6rem",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:t("label_profile_land")}),e.jsx("input",{type:"text",value:l.landSize,onChange:n=>r({...l,landSize:n.target.value}),style:{width:"100%",padding:"0.6rem",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:t("label_profile_crops")}),e.jsx("input",{type:"text",value:l.crops,onChange:n=>r({...l,crops:n.target.value}),style:{width:"100%",padding:"0.6rem",borderRadius:"4px",border:"1px solid #ccc"}})]})]}),e.jsxs("div",{style:{marginTop:"2rem",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:()=>a(!1),children:t("cancel")}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:t("save_changes")})]})]}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#666"},children:t("label_land_size")}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:i.landSize||t("not_set")})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#666"},children:t("label_major_crops")}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:i.crops&&i.crops.length>0?i.crops.join(", "):t("not_set")})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#666"},children:t("label_member_since")}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:"Dec 2023"})]})]})]}),e.jsx("hr",{style:{border:"none",borderTop:"1px solid #eee",margin:0}}),e.jsx("div",{style:{padding:"2rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0},children:t("notifications_title")}),d==="granted"?e.jsx("span",{style:{color:"green",fontWeight:"bold",fontSize:"0.9rem"},children:t("status_active")}):e.jsx("button",{onClick:j,className:"btn btn-primary",style:{padding:"6px 12px",fontSize:"0.9rem"},disabled:d==="loading",children:t(d==="loading"?"status_enabling":"btn_enable_notifications")})]})}),e.jsx("div",{style:{padding:"2rem",paddingTop:"0"},children:e.jsx("button",{onClick:v,style:{background:"none",border:"1px solid #ffcdd2",color:"#c62828",padding:"0.8rem 2rem",borderRadius:"4px",cursor:"pointer",marginTop:"1rem",display:"block",width:"100%"},children:t("btn_logout")})})]})}):e.jsxs("div",{className:"container",style:{textAlign:"center",padding:"4rem"},children:[e.jsx("h2",{children:t("login_view_profile")}),e.jsx("button",{className:"btn btn-primary",onClick:()=>g("/login"),children:t("login")})]})};export{T as default};
